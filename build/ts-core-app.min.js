var TSCore;!function(a){var b;!function(b){var c;!function(b){var c;!function(a){a.LOGIN_ATTEMPT_FAIL="login-attempt-fail",a.LOGIN_ATTEMPT_SUCCESS="login-attempt-success",a.LOGIN="login",a.LOGOUT="logout",a.SESSION_SET="session-set",a.SESSION_CLEARED="session-cleared"}(c=b.ManagerEvents||(b.ManagerEvents={}));var d=function(){function b(b){this.$q=b,this.events=new a.Events.EventEmitter,this._accountTypes=new a.Data.Dictionary,this._session=null}return b.prototype.registerAccountType=function(a,b){return this._accountTypes.set(a,b),this},b.prototype.getAccountTypes=function(){return this._accountTypes},b.prototype.getSession=function(){return this._session},b.prototype.setSession=function(a){this._session=a,this.events.trigger(c.SESSION_SET,{session:this._session})},b.prototype.clearSession=function(){var a=this._session;return this._session=null,this.events.trigger(c.SESSION_CLEARED,{session:a}),this},b.prototype.loggedIn=function(){return!!this._session},b.prototype.getAccountType=function(a){return this._accountTypes.get(a)},b.prototype.login=function(b,c){var d=this,e=this._accountTypes.get(b);return e?e.login(c).then(function(b){return d.setSession(b),d.events.trigger(a.App.Auth.ManagerEvents.LOGIN_ATTEMPT_SUCCESS,{credentials:c,session:d.getSession()}),d.events.trigger(a.App.Auth.ManagerEvents.LOGIN,{credentials:c,session:d.getSession()}),d.getSession()})["catch"](function(b){throw d.events.trigger(a.App.Auth.ManagerEvents.LOGIN_ATTEMPT_FAIL,{credentials:c,session:null}),b}):this.$q.reject()},b.prototype.logout=function(a){var b=this,d=this._accountTypes.get(a);return d&&this.loggedIn()?d.logout(this.getSession()).then(function(){b.events.trigger(c.LOGOUT,{session:b.getSession()})})["finally"](function(){b.clearSession()}):this.$q.reject()},b.$inject=["$q"],b}();b.Manager=d}(c=b.Auth||(b.Auth={}))}(b=a.App||(a.App={}))}(TSCore||(TSCore={}));var TSCore;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(a,b,c,d,e){this._accountTypeName=a,this._identity=b,this._startTime=c,this._expirationTime=d,this._token=e}return b.prototype.setIdentity=function(a){this._identity=a},b.prototype.getIdentity=function(){return this._identity},b.prototype.setToken=function(a){this._token=a},b.prototype.getToken=function(){return this._token},b.prototype.setExpirationTime=function(a){this._expirationTime=a},b.prototype.getExpirationTime=function(){return this._expirationTime},b.prototype.setStartTime=function(a){this._startTime=a},b.prototype.getStartTime=function(){return this._startTime},b.prototype.setAccountTypeName=function(a){this._accountTypeName=a},b.prototype.getAccountTypeName=function(){return this._accountTypeName},b.prototype.toJson=function(){return{accountTypeName:this.getAccountTypeName(),identity:this.getIdentity(),startTime:this.getStartTime(),expirationTime:this.getExpirationTime(),token:this.getToken()}},b.fromJson=function(b){return new a.App.Auth.Session(b.accountTypeName,b.identity,b.startTime,b.expirationTime,b.token)},b}();b.Session=c}(c=b.Auth||(b.Auth={}))}(b=a.App||(a.App={}))}(TSCore||(TSCore={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},TSCore;!function(a){var b;!function(b){var c;!function(b){!function(a){a[a.ONE=0]="ONE",a[a.MANY=1]="MANY"}(b.ModelRelationType||(b.ModelRelationType={}));var c=(b.ModelRelationType,function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.relations=function(){return{}},b.prototype.toObject=function(b){void 0===b&&(b=!0);var c=a.prototype.toObject.call(this);return b===!1&&_.each(_.keys(this["static"].relations()),function(a){c[a]&&delete c[a]}),c},b}(a.Data.Model));b.Model=c}(c=b.Data||(b.Data={}))}(b=a.App||(a.App={}))}(TSCore||(TSCore={}));var TSCore;!function(a){var b;!function(b){var c;!function(b){var c=function(){function c(b,c,d,e){this.$q=b,this.$injector=c,this.endpoint=d,this.modelClass=e,this._loadedRequestConfigs=new a.Data.Collection,this._pendingRequests=new a.Data.Dictionary,this.store=new a.Data.ModelDictionary(e)}return c.prototype.list=function(a,b,c){var d=this,e={requestOptions:b},f=JSON.stringify(e);if(this._loadedRequestConfigs.contains(f)&&!c){var g=this.store.values(),h=[];return _.each(g,function(b){h.push(d._composeModel(b,a))}),this.$q.all(h)}if(this._pendingRequests.contains(f))return this._pendingRequests.get(f);c&&(b=_.defaults(b||{},{cache:!1}));var i=this.endpoint.list(a,b).then(function(b){return d._loadedRequestConfigs.add(f),d._pendingRequests.remove(f),d._processListResponse(b,a)});return this._pendingRequests.set(f,i),i},c.prototype.get=function(a,b,c,d){var e=this,f={id:a,requestOptions:c},g=JSON.stringify(f);if(this.queryCached(a,b)&&!d){var h=this.store.get(a);return this._composeModel(h,b)}if(this._pendingRequests.contains(g))return this._pendingRequests.get(g);d&&(c=_.defaults(c||{},{cache:!1}));var i=this.endpoint.get(a,b,c).then(function(a){return e._loadedRequestConfigs.add(g),e._pendingRequests.remove(g),e._processGetResponse(a,b)});return this._pendingRequests.set(g,i),i},c.prototype.create=function(a,b){var c=this;return this.endpoint.create(a.toObject(!1),b).then(function(b){var d=a;return b.data?d=c.importOne(b.data):c.store.set(a[c.modelClass.primaryKey()],a),d})},c.prototype.update=function(a,b){var c=this,d=a[this.modelClass.primaryKey()];return this.endpoint.update(d,a.toObject(!1),b).then(function(b){var d=a;return b.data?d=c.importOne(a):c.store.set(a[c.modelClass.primaryKey()],a),d})},c.prototype.queryCached=function(a,c){var d=this;if(!this.store.contains(a))return!1;var e=this.store.get(a),f=c&&c.include||[];if(!f.length)return!0;var g=!1;return _.each(f,function(a){if(!g){var c=e["static"].relations()[a.relation],f=d.$injector.get(c.store),h=c.localKey;switch(c.type){case b.ModelRelationType.ONE:var i=e[h];f.queryCached(i,a.queryOptions)||(g=!0);break;case b.ModelRelationType.MANY:var j=e[h];_.each(j,function(b){f.queryCached(b,a.queryOptions)||(g=!0)})}}}),!g},c.prototype.getMany=function(a,b,c,d){var e=this,f=[];return _.each(a,function(a){f.push(e.get(a,b,c,d))}),this.$q.all(f).then(function(a){return _.filter(a,function(a){return null!=a&&void 0!=a})})},c.prototype.listStored=function(){return this.store.values()},c.prototype.getStored=function(a){return this.store.get(a)},c.prototype.getManyStored=function(a){var b=this,c=[];return _.each(a,function(a){c.push(b.store.get(a))}),c},c.prototype.importOne=function(a){return this._extractRelationData(a),this.store.addData(a)},c.prototype.importMany=function(a){var b=this;return _.each(a,function(a){b._extractRelationData(a)}),this.store.addManyData(a)},c.prototype._processListResponse=function(a,b){var c=this,d=this.importMany(a.data),e=[];return _.each(d,function(a){e.push(c._composeModel(a,b))}),this.$q.all(e)},c.prototype._processGetResponse=function(a,b){var c=this.importOne(a.data);return this._composeModel(c,b)},c.prototype._composeModel=function(a,c){var d=this,e=[],f=c&&c.include||[],g=_.clone(a);return _.each(f,function(a){var c=g["static"].relations()[a.relation];if(c){var f=d.$injector.get(c.store),h=c.localKey;switch(c.type){case b.ModelRelationType.ONE:var i=g[h],j=f.get(i,a.queryOptions);j.then(function(b){g[a.relation]=b}),e.push(j);break;case b.ModelRelationType.MANY:var k=_.isArray(g[h])?g[h]:[],l=f.getMany(k,a.queryOptions);l.then(function(b){g[a.relation]=b}),e.push(l)}}}),this.$q.all(e).then(function(){return g})},c.prototype._extractRelationData=function(a){var c=this;_.each(this.modelClass.relations(),function(d){var e=d.dataKey,f=e&&a?a[e]:null;if(f){var g=c.$injector.get(d.store);switch(d.type){case b.ModelRelationType.ONE:g.importOne(g.endpoint.transformResponse(f));break;case b.ModelRelationType.MANY:g.importMany(_.map(f,g.endpoint.transformResponse))}}})},c.$inject=["$q","$injector"],c}();b.RemoteModelStore=c}(c=b.Data||(b.Data={}))}(b=a.App||(a.App={}))}(TSCore||(TSCore={}));var TSCore;!function(a){var b;!function(a){var b;!function(a){a.Method={GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE"};var b=function(){function a(a){this.$http=a,this.defaultHeaders={}}return a.prototype.setProtocol=function(a){this.protocol=a},a.prototype.setHostname=function(a){this.hostname=a},a.prototype.setDefaultHeader=function(a,b){this.defaultHeaders[a]=b},a.prototype.unsetDefaultHeader=function(a){delete this.defaultHeaders[a]},a.prototype.request=function(a,b){return a=_.defaults(a,b),a=this._parseOptions(a),this.$http(a)},a.prototype._parseOptions=function(a){return a.headers=a.headers||{},_.each(this.defaultHeaders,function(b,c){a.headers[c]=b}),a.url=this._buildUrl(a.url),a.url=this._interpolateUrl(a.url,a.urlParams||{}),a},a.prototype._buildUrl=function(a){return this.protocol+this.hostname+a},a.prototype._interpolateUrl=function(a,b){var c=this;return b=b||{},a=a.replace(/(\(\s*|\s*\)|\s*\|\s*)/g,""),a=a.replace(/:([a-z]\w*)/gi,function(a,d){return c._popFirstKey(b,d)||""}),a=a.replace(/(^|[^:])[\/]{2,}/g,"$1/"),a=a.replace(/\/+$/i,"")},a.prototype._popFirstKey=function(a,b){return a.hasOwnProperty(b)?this._popKey(a,b):void 0},a.prototype._popKey=function(a,b){var c=a[b];return delete a[b],c},a}();a.Api=b}(b=a.Http||(a.Http={}))}(b=a.App||(a.App={}))}(TSCore||(TSCore={}));var TSCore;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a){this.apiService=a,this.extractSingleCallback=_.bind(this.extractSingle,this),this.extractMultipleCallback=_.bind(this.extractMultiple,this)}return b.prototype.request=function(a,b,c,d,e){return this.apiService.request({method:a,url:"/"+this.path+b,urlParams:c},_.defaults(d||{},e||{}))},b.prototype.getRequest=function(b,c,d,e){return this.request(a.Method.GET,b,c,d,e)},b.prototype.postRequest=function(b,c,d,e,f){return this.request(a.Method.POST,b,c,_.defaults(e||{},{data:d}),f)},b.prototype.putRequest=function(b,c,d,e,f){return this.request(a.Method.PUT,b,c,_.defaults(e||{},{data:d}),f)},b.prototype.deleteRequest=function(b,c,d,e){return this.request(a.Method.DELETE,b,c,d,e)},b.prototype.list=function(a,b){return this.getRequest("/",{},b).then(this.extractMultipleCallback)},b.prototype.get=function(a,b,c){return this.getRequest("/:id",{id:a},c).then(this.extractSingleCallback)},b.prototype.update=function(a,b,c,d){return this.putRequest("/:id",{id:a},b,d).then(this.extractSingleCallback)},b.prototype.create=function(a,b,c){return this.postRequest("/",{},a,c).then(this.extractSingleCallback)},b.prototype["delete"]=function(a,b,c){return this.deleteRequest("/:id",{id:a},c).then(this.extractSingleCallback)},b.prototype.extractMultiple=function(a){return{response:a,fullData:a.data,data:_.map(a.data[this.multipleProperty],this.transformResponse)}},b.prototype.extractSingle=function(a){return{response:a,fullData:a.data,data:this.transformResponse(a.data[this.singleProperty])}},b.prototype.transformResponse=function(a){return a},b.$inject=["apiService"],b}();a.ApiEndpoint=b}(b=a.Http||(a.Http={}))}(b=a.App||(a.App={}))}(TSCore||(TSCore={}));var TSCore;!function(a){var b;!function(b){var c;!function(b){var c;!function(a){a.REQUEST="httpRequest",a.REQUEST_ERROR="httpRequestError",a.RESPONSE="httpResponse",a.RESPONSE_ERROR="httpResponseError",a.RESPONSE_500_ERRORS="httpResponse500Errors",a.RESPONSE_401_ERROR="httpResponseError404"}(c=b.HttpInterceptorEvents||(b.HttpInterceptorEvents={}));var d=function(){function b(b){var d=this;this.$q=b,this.events=new a.Events.EventEmitter,this.request=function(a){return d.events.trigger(c.REQUEST,{config:a}),a},this.requestError=function(a){return d.events.trigger(c.REQUEST_ERROR,{rejection:a}),d.$q.reject(a)},this.response=function(a){return d.events.trigger(c.RESPONSE,{response:a}),a},this.responseError=function(a){return d.events.trigger(c.RESPONSE_ERROR,{rejection:a}),(0===a.status||"5"===String(a.status).charAt(0))&&d.events.trigger(c.RESPONSE_500_ERRORS,{rejection:a}),401===a.status&&d.events.trigger(c.RESPONSE_401_ERROR,{rejection:a}),d.$q.reject(a)}}return b.$inject=["$q"],b}();b.HttpInterceptor=d}(c=b.Interceptors||(b.Interceptors={}))}(b=a.App||(a.App={}))}(TSCore||(TSCore={}));var TSCore;!function(a){var b;!function(b){var c;!function(b){var c;!function(a){a.STATE_CHANGE_START="$stateChangeStart",a.STATE_CHANGE_SUCCESS="$stateChangeSuccess",a.STATE_CHANGE_ERROR="$stateChangeError",a.STATE_NOT_FOUND="$stateNotFound"}(c||(c={}));var d;!function(a){a.PUBLIC="public",a.UNAUTHORIZED="unauthorized",a.AUTHORIZED="authorized"}(d=b.StateAccessLevels||(b.StateAccessLevels={}));var e;!function(a){a.FIRST_ROUTE="firstRoute",a.STATE_CHANGE_START="stateChangeStart",a.ENTERING_AUTHORIZED_AREA="enteringAuthorizedArea",a.ENTERING_UNAUTHORIZED_AREA="enteringUnauthorizedArea",a.ENTERING_PUBLIC_AREA="enteringPublicArea"}(e=b.StateInterceptorEvents||(b.StateInterceptorEvents={}));var f=function(){function b(b){this.$rootScope=b,this.events=new a.Events.EventEmitter,this._firstRoute=null,this._lastRoute=null}return b.prototype.init=function(){this._attachRouterEvents()},b.prototype._attachRouterEvents=function(){this.$rootScope.$on(c.STATE_CHANGE_START,_.bind(this._$stateChangeStart,this))},b.prototype._$stateChangeStart=function(a,b,c,f,g){var h={event:a,toState:b,toParams:c,fromState:f,fromParams:g};if(!f||f.accessLevel!==b.accessLevel){var i;switch(b.accessLevel){case d.AUTHORIZED:i=e.ENTERING_AUTHORIZED_AREA;break;case d.PUBLIC:i=e.ENTERING_PUBLIC_AREA;break;default:case d.UNAUTHORIZED:i=e.ENTERING_UNAUTHORIZED_AREA}this.events.trigger(i,h)}this._lastRoute={toState:b,toParams:c},this._firstRoute||(this._firstRoute=this._lastRoute,this.events.trigger(e.FIRST_ROUTE,h)),this.events.trigger(e.STATE_CHANGE_START,h)},b.prototype.getFirstRoute=function(){return this._firstRoute},b.$inject=["$rootScope"],b}();b.StateInterceptor=f}(c=b.Interceptors||(b.Interceptors={}))}(b=a.App||(a.App={}))}(TSCore||(TSCore={}));var TSCore;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(){}return b.prototype.createModule=function(){return angular.module("app",[])},b.prototype.getValues=function(){return[]},b.prototype.getConfigs=function(){return[]},b.prototype.getServices=function(){return[]},b.prototype.getFactories=function(){return[]},b.prototype.getFilters=function(){return[]},b.prototype.getControllers=function(){return[]},b.prototype.getDirectives=function(){return[]},b.prototype.getRuns=function(){return[]},b.prototype.run=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b]},b.prototype.start=function(b){var c=this;this._module=this.createModule();var d=this.getValues();_.each(d,function(a,b){c._module.value(b,a)});var e=this.getConfigs();_.each(e,function(a){c._module.config(a)});var f=this.getServices();_.each(f,function(a,b){c._module.service(b,a)});var g=this.getFactories();_.each(g,function(a,b){c._module.factory(b,a)});var h=this.getFilters();_.each(h,function(a,b){c._module.filter(b,a)});var i=this.getControllers();_.each(i,function(a,b){c._module.controller(b,a)});var j=this.getDirectives();_.each(j,function(a,b){var d=a.$inject||[],e=c,f=function(){return new(Function.prototype.bind.apply(a,e._parseArgs(arguments)))},g=d.concat([f]);c._module.directive(b,g)});var k=this.getRuns();if(_.each(k,function(a){c._module.run(a)}),this.run){var l=this.$runInject||[];l.push(_.bind(this.run,this)),this._module.run(l)}for(var m in this)a.Utils.Text.startsWith(m,"_init")&&_.isFunction(m)&&this[m]();return angular.element(document).ready(function(){angular.bootstrap(document,[b])}),this._module},b.prototype._parseArgs=function(a){var b=[null];for(var c in a)b.push(a[c]);return b},b.prototype.getModule=function(){return this._module},b}();b.Bootstrap=c}(c=b.System||(b.System={}))}(b=a.App||(a.App={}))}(TSCore||(TSCore={}));